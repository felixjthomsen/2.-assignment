---
title: "BA-BINTV2006U  Programming and Data Analysis for Business: Exercise 1"
author: "by Felix Thomsen, Alexander Schiøtz, Anders Laurents, Bertram Hage"
date: "2024-10-01"
output: 
  html_document:
    theme: sandstone
    code_folding: show
---

## 1. packages + dataload
<!-- 2. Load the dataset into R and inspect its structure. How many rows, how many columns, what is the
summary statistics for the numeric variables? -->
```{r init, warning = FALSE, message=FALSE}
library(knitr)
library(markdown)
library(rmarkdown)
library(tidyverse)
library(lubridate)
library(readxl)
theme_set(theme_bw())
```
```{r, message=FALSE}
data <- read_csv("data.csv")

# Remove outliers from the dataset
remove_outliers <- function(df, cols) {
  for (col in cols) {
    Q1 <- quantile(df[[col]], 0.25)
    Q3 <- quantile(df[[col]], 0.75)
    IQR <- Q3 - Q1
    df <- df %>% filter(df[[col]] >= (Q1 - 1.5 * IQR) & df[[col]] <= (Q3 + 1.5 * IQR))
  }
  return(df)
}

numeric_cols <- sapply(data, is.numeric)
data <- remove_outliers(data, names(data)[numeric_cols])
```

## Create a point plot or jitter plot
```{r}
#Jitter plot for hours studied and exam score
ggplot(data, aes(x = Hours_Studied, y = Exam_Score, color = Gender)) + geom_jitter() + scale_fill_manual(values = c("blue", "pink")) + labs(title = "Jitter plots of hours studied and exam scores + colored by Gender")
```

## Create a boxplot or a bar plot. 
To visualize the distribution of "Hours_Studied" by "Gender" we selected a boxplot:
```{r}
# data$Hours_Studied

ggplot(data, aes(x = data$Gender, y = data$Hours_Studied)) + geom_boxplot() +   labs(title = "Boxplot of Hours Studied by Gender", x = "Gender", y = "Hours Studied")
```

Generally we see that males and females studies the same amount of hours.

## Generate a histogram to visualize the distribution of one of the numerical variables.
```{r}

ggplot(data, aes(x = Exam_Score)) + geom_histogram(binwidth = 1, aes(fill = ..count..)) + scale_fill_gradient(low = "green", high = "blue") + labs(title = "Histogram of Exam Scores by Student", x = "Exam Score" , y = "Counts of Students")

```

## Create a visualization of own choice that you have “polished”,  and write what the purpose is with  your visualization. (Is it for a managerial decision? A publication? How?)
The plot below shows the number of students sorted by Parental involvement. The purpose of this plot is to show the distribution of students based on their parental involvement. This could be useful for a school to see how many students have a high parental involvement and how many have a low parental involvement. This could be further analysed to see if there is a correlation between parental involvement and student performance. First of all the plot greatly visualizes if there is a noticeable difference in the number of students with high and low parental involvement. Most students have a medium parental involvement, follow by high involvement and lastly low involvement. It would be interesting to see if there is a correlation between parental involvement and student performance fx by looking at exam_scores. Parental involvement, together with other parameters will be investigated in a linear model later to see if there is a correlation between these paramteres and student performance.
```{r}
ggplot(data, aes(x=Parental_Involvement, fill = Parental_Involvement))+
  geom_bar() +
  labs(title="Number of students sorted by Parental involvement", x="Parental involvement", y="Students")+
  ylim(0,4000) +
  theme(legend.position = "none",axis.text = element_text(size = 12))
```

## Create a linear model in which you model using at least tree input/independant variables. 
```{r}
print("anders er gay")
```
## Visualize the model output using dotwhiskers and stargazer
```{r}
print("anders er gay")
```

## Reflect on the model – how could it be improved? 

## Reflect on how you have used Generative AI (if you have).