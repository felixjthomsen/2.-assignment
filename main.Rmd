---
title: "BA-BINTV2006U  Programming and Data Analysis for Business: Exercise 1"
author: "by Felix Thomsen, Alexander Schiøtz, Anders Laurents, Bertram Hage"
date: "2024-10-01"
output: 
  html_document:
    theme: sandstone
    code_folding: show
---

## 1. packages + dataload
<!-- 2. Load the dataset into R and inspect its structure. How many rows, how many columns, what is the
summary statistics for the numeric variables? -->
```{r init, warning = FALSE, message=FALSE}
library(knitr)
library(markdown)
library(rmarkdown)
library(tidyverse)
library(lubridate)
library(readxl)
theme_set(theme_bw())
```
```{r, message=FALSE}
data <- read_csv("data.csv")
```

## Create a point plot or jitter plot
```{r}
#Jitter plot for hours studied and exam score
ggplot(data, aes(x = Hours_Studied, y = Exam_Score, color = Gender)) + geom_jitter() + scale_fill_manual(values = c("blue", "pink")) + labs(title = "Jitter plots of hours studied and exam scores + colored by Gender")
```

## Create a boxplot or a bar plot. 
To visualize the distribution of "Hours_Studied" by "Gender" we selected a boxplot:
```{r}
# data$Hours_Studied

ggplot(data, aes(x = data$Gender, y = data$Hours_Studied)) + geom_boxplot() +   labs(title = "Boxplot of Hours Studied by Gender", x = "Gender", y = "Hours Studied")
```

Generally we see that males and females studies the same amount of hours.

## Generate a histogram to visualize the distribution of one of the numerical variables.
```{r}

ggplot(data, aes(x = Exam_Score)) + geom_histogram(binwidth = 1, aes(fill = ..count..)) + scale_fill_gradient(low = "green", high = "blue") + labs(title = "Histogram of Exam Scores by Student", x = "Exam Score" , y = "Counts of Students")

```

## Create a visualization of own choice that you have “polished”,  and write what the purpose is with  your visualization. (Is it for a managerial decision? A publication? How?)
```{r}
ggplot(data, aes(x=Parental_Involvement, fill = Parental_Involvement))+
  geom_bar() +
  labs(title="Number of students sorted by Parental involvement", x="Parental involvement", y="Students")+
  ylim(0,4000) +
  theme(legend.position = "none",axis.text = element_text(size = 12))
```

## Create a linear model in which you model using at least tree input/independant variables. 
```{r}
lm1 <- lm(Exam_Score ~ Hours_Studied + Attendance + Sleep_Hours, data = data)
lm2 <- lm(Exam_Score ~ Hours_Studied + Physical_Activity + Sleep_Hours, data = data)
lm3 <- lm(Exam_Score ~ Hours_Studied + Attendance + Physical_Activity, data = data)
lm4 <- lm(Exam_Score ~ Hours_Studied + Attendance + Sleep_Hours+ Previous_Scores + Tutoring_Sessions + Physical_Activity, data = data)
```

```{r}
anova(lm1,lm2,lm3, lm4)
```

```{r, echo=F,fig.height = 5, fig.align = 'center'}
par(mfrow=c(2,4))
plot(lm1,2, main="Model 1")
plot(lm2,2, main="Model 2")
plot(lm3,2, main="Model 3")
plot(lm4,2, main='Model 4')
plot(lm1,1)
plot(lm2,1)
plot(lm3,1)
plot(lm4,1)
```

## Visualize the model output using dotwhiskers and stargazer
```{r, warning=F, message=F, fig.height = 4, fig.align = 'center'}
library(dotwhisker)
dwplot(lm4, dot_args = list(size = 2, color = "black"),
       whisker_args = list(color = "black"),
       vline = geom_vline(xintercept = 0, colour = "grey50", linetype = 2)) +
  ggtitle("Dot-and-Whisker plot for a linear regression model") +
  theme(plot.title = element_text(hjust = 1.0))
```

```{r, warning=FALSE, eval=FALSE}
library(stargazer)
fil <- stargazer(lm1, lm2, lm3, lm4 ,title="Results", type = "html", align=TRUE)
write(fil, file = "results.html")
```

## Reflect on the model – how could it be improved? 

## Reflect on how you have used Generative AI (if you have).